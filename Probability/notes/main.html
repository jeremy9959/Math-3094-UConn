<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Probability and Bayes Theorem</title>
  <style>
    html {
      line-height: 1.7;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 40em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin-top: 1.7em;
    }
    a {
      color: blue;
    }
    a:visited {
      color: blue;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.7em;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1.7em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1.7em 0 1.7em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      font-style: italic;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      background-color: #f0f0f0;
      font-size: 85%;
      margin: 0;
      padding: .2em .4em;
    }
    pre {
      line-height: 1.5em;
      padding: 1em;
      background-color: #f0f0f0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin-top: 1.7em;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
    }
    th, td {
      border-bottom: 1px solid lightgray;
      padding: 1em 3em 1em 0;
    }
    header {
      margin-bottom: 6em;
      text-align: center;
    }
    nav a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style>
  body {
   max-width: 60em ; 
  }
  </style>
  
  <!-- pandoc-eqnos: equation style -->
  <style>
    .eqnos { display: inline-block; position: relative; width: 100%; }
    .eqnos br { display: none; }
    .eqnos-number { position: absolute; right: 0em; top: 50%; line-height: 0; }
  </style>
</head>
<body>
<h1 data-number="1" id="probability-and-bayes-theorem"><span class="header-section-number">1</span> Probability and Bayes Theorem</h1>
<h2 data-number="1.1" id="introduction"><span class="header-section-number">1.1</span> Introduction</h2>
<p>Probability theory is one of the three central mathematical tools in machine learning, along with multivariable calculus and linear algebra. Tools from probability allow us to manage the uncertainty inherent in data collected from real world experiments, and to measure the reliability of predictions that we might make from that data. In these notes, we will review some of the basic terminology of probability and introduce Bayesian inference as a technique in machine learning problems.</p>
<p>This will only be a superficial introduction to ideas from probability. For a thorough treatment, see <a href="https://probability.oer.math.uconn.edu/3160-oer">this open-source introduction to probability.</a> For a more applied emphasis, I recommend the excellent online course <a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-041-probabilistic-systems-analysis-and-applied-probability-fall-2010/">Probabilistic Systems Analysis and Applied Probability</a> and its associated text <span class="citation" data-cites="Bertsekas">[<a href="#ref-Bertsekas" role="doc-biblioref">1</a>]</span>.</p>
<h2 data-number="1.2" id="probability-basics"><span class="header-section-number">1.2</span> Probability Basics</h2>
<p>The theory of probability begins with a set <span class="math inline">\(X\)</span> of possible events or outcomes, together with a “probability” function <span class="math inline">\(P\)</span> on (certain) subsets of <span class="math inline">\(X\)</span> that measures “how likely” that combination of events is to occur.</p>
<p>The set <span class="math inline">\(X\)</span> can be discrete or continuous. For example, when flipping a coin, our set of possible events would be the discrete set <span class="math inline">\(\{H,T\}\)</span> corresponding to the possible events of flipping heads or tails. When measuring the temperature using a thermometer, our set of possible outcomes might be the set of real numbers, or perhaps an interval in <span class="math inline">\(\mathbb{R}\)</span>. The thermometer’s measurement is random because it is affected by, say, electronic noise, and so its reading is the true temperature perturbed by a random amount.</p>
<p>The values of <span class="math inline">\(P\)</span> are between <span class="math inline">\(0\)</span>, meaning that the event <em>will not</em> happen, and <span class="math inline">\(1\)</span>, meaning that it is certain to occur. As part of our set up, we assume that the total chance of some event from <span class="math inline">\(X\)</span> occurring is <span class="math inline">\(1\)</span>, so that <span class="math inline">\(P(X)=1\)</span>; and the chance of “nothing” happening is zero, so <span class="math inline">\(P(\emptyset)=0\)</span>. And if <span class="math inline">\(U\subset X\)</span> is some collection, then <span class="math inline">\(P(U)\)</span> is the chance of an event from <span class="math inline">\(U\)</span> occurring.</p>
<p>The last ingredient of this picture of probability is additivity. Namely, we assume that if <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> are subsets of <span class="math inline">\(X\)</span> that are disjoint, then <span class="math display">\[
P(U\cup V)=P(U)+P(V).
\]</span> Even more generally, we assume that this holds for (countably) infinite collections of disjoint subsets <span class="math inline">\(U_1,U_2,\ldots\)</span>, where <span class="math display">\[
P(U_1\cup U_2\cup\cdots)=\sum_{i=1}^{\infty} P(U_i)
\]</span></p>
<p><strong>Definition:</strong> The combination of a set <span class="math inline">\(X\)</span> of possible outcomes and a probability function <span class="math inline">\(P\)</span> on subsets of <span class="math inline">\(X\)</span> that satisfies <span class="math inline">\(P(X)=1\)</span>, <span class="math inline">\(0\le P(U)\le 1\)</span> for all <span class="math inline">\(U\)</span>, and is additive on countable disjoint collections of subsets of <span class="math inline">\(X\)</span> is called a (naive) probability space. <span class="math inline">\(X\)</span> is called the <em>sample space</em> and the subsets of <span class="math inline">\(X\)</span> are called <em>events</em>.</p>
<p><strong>Warning:</strong> The reason for the term “naive” in the above definition is that, if <span class="math inline">\(X\)</span> is an uncountable set such as the real numbers <span class="math inline">\(\mathbb{R}\)</span>, then the conditions in the definition are self-contradictory. This is a deep and rather surprising fact. To make a sensible definition of a probability space, one has to restrict the domain of the probability function <span class="math inline">\(P\)</span> to certain subsets of <span class="math inline">\(X\)</span>. These ideas form the basis of the mathematical subject known as measure theory. In these notes we will work with explicit probability functions and simple subsets such as intervals that avoid these technicalities.</p>
<h3 data-number="1.2.1" id="discrete-probability-examples"><span class="header-section-number">1.2.1</span> Discrete probability examples</h3>
<p>The simplest probability space arises in the analysis of coin-flipping. As mentioned earlier, the set <span class="math inline">\(X\)</span> contains two elements <span class="math inline">\(\{H,T\}\)</span>. The probability function <span class="math inline">\(P\)</span> is determined by its value <span class="math inline">\(P(\{H\})=p\)</span>, where <span class="math inline">\(0\le p\le 1\)</span>, which is the chance of the coin yielding a “head.” Since <span class="math inline">\(P(X)=1\)</span>, we have <span class="math inline">\(P(\{T\})=1-p\)</span>.</p>
<p>Other examples of discrete probability spaces arise from dice-rolling and playing cards. For example, suppose we roll two six-sided dice. There are <span class="math inline">\(36\)</span> possible outcomes from this experiment, each equally likely. If instead we consider the sum of the two values on the dice, our outcomes range from <span class="math inline">\(2\)</span> to <span class="math inline">\(12\)</span> and the probabilities of these outcomes are given by</p>
<table>
<thead>
<tr class="header">
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>10</th>
<th>11</th>
<th>12</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1/36</td>
<td>1/18</td>
<td>1/12</td>
<td>1/9</td>
<td>5/36</td>
<td>1/6</td>
<td>5/36</td>
<td>1/9</td>
<td>1/12</td>
<td>1/18</td>
<td>1/36</td>
<td></td>
</tr>
</tbody>
</table>
<p>A traditional deck of <span class="math inline">\(52\)</span> playing cards contains <span class="math inline">\(4\)</span> aces. Assuming that the chance of drawing any card is the same (and is therefore equal to <span class="math inline">\(1/52\)</span>), the probability of drawing an ace is <span class="math inline">\(4/52=1/13\)</span> since <span class="math display">\[
P(\{A_{\clubsuit},A_{\spadesuit},A_{\heartsuit},A_{\diamondsuit}\}) = 4P(\{A_{\clubsuit}\})=4/52=1/13
\]</span></p>
<h3 data-number="1.2.2" id="continuous-probability-examples"><span class="header-section-number">1.2.2</span> Continuous probability examples</h3>
<p>When the set <span class="math inline">\(X\)</span> is continuous, such as in the temperature measurement, we measure <span class="math inline">\(P(U)\)</span>, where <span class="math inline">\(U\subset X\)</span>, by giving a “probability density function” <span class="math inline">\(f:X\to \mathbb{R}\)</span> and declaring that <span class="math display">\[
P(U) = \int_{U}f(x) dX.
\]</span> Notice that our function <span class="math inline">\(f(x)\)</span> has to satisfy the condition <span class="math display">\[
P(X)=\int_{X} f(x)dX = 1.
\]</span></p>
<p>For example, in our temperature measurement example, suppose the “true” outside temperature is <span class="math inline">\(t_0\)</span>, and our thermometer gives a reading <span class="math inline">\(t\)</span>. Then a good model for the random error is to assume that the error <span class="math inline">\(t-t_0\)</span> is governed by the density function <span class="math display">\[
f_\sigma(x) = \frac{1}{\sigma\sqrt{2\pi}}e^{-x^2/2\sigma^2}
\]</span> where <span class="math inline">\(\sigma\)</span> is a parameter. In a continuous situation such as this one, the probability of any particular outcome in <span class="math inline">\(X\)</span> is zero since <span class="math display">\[
P(\{t\})=\int_{t}^{t}f_{\sigma}(x)dx = 0
\]</span> Still, the shape of the density function does tell you where the values are concentrated – values where the density function is larger are more likely than those where it is smaller.</p>
<p>With this density function, the error in our measurement is given by <span id="eq:normal" class="eqnos"><span class="math display">\[
P(|t-t_0|&lt;\delta)=\int_{-\delta}^{\delta} \frac{1}{\sigma\sqrt{2\pi}}e^{-x^2/2\sigma^2} dx
\]</span><span class="eqnos-number">(1)</span></span></p>
<p>The parameter <span class="math inline">\(\sigma\)</span> (called the <em>standard deviation</em>) controls how tightly the thermometer’s measurement is clustered around the true value <span class="math inline">\(t_0\)</span>; when <span class="math inline">\(\sigma\)</span> is large, the measurements are scattered widely, when small, they are clustered tightly. See fig. <a href="#fig:density">1</a>.</p>
<div id="fig:density" class="fignos">
<figure>
<img src="../img/density.png" alt="Figure 1: Normal Density" /><figcaption aria-hidden="true"><span>Figure 1:</span> Normal Density</figcaption>
</figure>
</div>
<h2 data-number="1.3" id="conditional-probability-and-bayes-theorem"><span class="header-section-number">1.3</span> Conditional Probability and Bayes Theorem</h2>
<p>The theory of conditional probability gives a way to study how partial information about an event informs us about the event as a whole. For example, suppose you draw a card at random from a deck. As we’ve seen earlier, the chance that card is an ace is <span class="math inline">\(1/13\)</span>. Now suppose that you learn that (somehow) that the card is definitely not a jack, king, or queen. Since there are 12 cards in the deck that are jacks, kings, or queens, the card you’ve drawn is one of the remaining 40 cards, which includes 4 aces. Thus the chance you are holding an ace is now <span class="math inline">\(4/40=1/10\)</span>.</p>
<p>In terms of notation, if <span class="math inline">\(A\)</span> is the event “my card is an ace” and <span class="math inline">\(B\)</span> is the event “my card is not a jack, queen, or king” then we say that <em>the probability of <span class="math inline">\(A\)</span> given <span class="math inline">\(B\)</span></em> is <span class="math inline">\(1/10\)</span>. The notation for this is <span class="math display">\[
P(A|B) = 1/10.
\]</span></p>
<p>More generally, if <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are events from a sample space <span class="math inline">\(X\)</span>, and <span class="math inline">\(P(B)&gt;0\)</span>, then <span class="math display">\[
P(A|B) = \frac{P(A\cap B)}{P(B)},
\]</span> so that <span class="math inline">\(P(A|B)\)</span> measures the chance that <span class="math inline">\(A\)</span> occurs among those situations in which <span class="math inline">\(B\)</span> occurs.</p>
<h3 data-number="1.3.1" id="bayes-theorem"><span class="header-section-number">1.3.1</span> Bayes Theorem</h3>
<p>Bayes theorem is a foundational result in probability.</p>
<p><strong>Theorem:</strong> Bayes Theorem says <span class="math display">\[
P(A|B) = \frac{P(B|A)P(A)}{P(B)}.
\]</span></p>
<p>If we use the definition of conditional probability given above, this is straightforward: <span class="math display">\[
\frac{P(B|A)P(A)}{P(B)} = \frac{P(B\cap A)}{P(B)} = P(A|B).
\]</span></p>
<h3 data-number="1.3.2" id="an-example"><span class="header-section-number">1.3.2</span> An example</h3>
<p>To illustrate conditional probability, let’s consider what happens when we administer the most reliable COVID-19 test, the PCR test, to an individual drawn from the population at large. There are two possible test results (positive and negative) and two possible true states of the person being tested (infected and not infected). Suppose I go to the doctor and get a COVID test which comes back positive. What is the probability that I actually have COVID?</p>
<p>Let’s let <span class="math inline">\(S\)</span> and <span class="math inline">\(W\)</span> stand for infected (sick) and not infected (well), and let <span class="math inline">\(+/-\)</span> stand for test positive or negative. Note that there are four possible outcomes of our experiment:</p>
<ul>
<li>test positive and infected (S+) – this is a <em>true positive</em>.</li>
<li>test positive and not infected (W+) – this is a <em>false positive</em>.</li>
<li>test negative and infected (S-) – this is a <em>false negative</em>.</li>
<li>test negative and not infected (W-) – this is a <em>true negative</em>.</li>
</ul>
<p>The <a href="https://www.icd10monitor.com/false-positives-in-pcr-tests-for-covid-19">CDC says</a> that the chance of a false positive – that is, the percentage of samples from well people that incorrectly yields a positive result – is about one-half of one percent, or 5 in 1000.</p>
<p>In other words, <span class="math display">\[
P(+|W) = P(W+)/P(W) = 5/1000=1/200
\]</span></p>
<p>On the other hand, the CDC tells us that chance of a false negative is 1 in 4, so <span class="math display">\[
P(-|S) = P(S-)/P(S) = .25.
\]</span> Since <span class="math inline">\(P(S-)+P(S+)=P(S).\)</span> since every test is either positive or negative, we have <span class="math display">\[
P(+|S) = .75.
\]</span></p>
<p>Suppose furthermore that the overall incidence of COVID-19 in the population is p. In other words, <span class="math inline">\(P(S)=p\)</span> so <span class="math inline">\(P(W)=1-p\)</span>. Then <span class="math display">\[P(S+)=P(S)P(+|S)=.75p\]</span> and <span class="math display">\[
P(W+)=P(W)P(+|W)=.005(1-p).
\]</span> Putting these together we get <span class="math inline">\(P(+)=.005+.745p\)</span></p>
<p>What I’m interested in is <span class="math inline">\(P(S|+)\)</span> – the chance that I’m sick, given that my test result was positive. By Bayes Theorem, <span class="math display">\[
P(S|+)=\frac{P(+|S)P(S)}{P(+)}=.75p/(.005+.745p)=\frac{750p}{5+745p}.
\]</span></p>
<p>As fig. <a href="#fig:covidfn">2</a> shows, if the population incidence is low then a positive test is far from conclusive. Indeed, if the overall incidence of COVID is one percent, then a positive test result only implies a 60 percent chance that I am in fact infected.</p>
<p>Just to fill out the picture, we have <span class="math display">\[
P(-) = P(S-)+P(W-)=(P(S)-P(S+))+(P(W)-P(W+))
\]</span> which yields <span class="math display">\[
P(-)=1-.005+.005p-.75p = .995-.745p.
\]</span> Using Bayes Theorem, we obtain <span class="math display">\[
P(S|-) = \frac{P(-|S)P(S)}{P(-)} = .25p/(.995-.745p) =\frac{250p}{995-745p}.
\]</span> In this case, even though the false negative rate is pretty high (25 percent) overall, if the population incidence is one percent, then the probability that you’re sick given a negative result is only about <span class="math inline">\(.25\)</span> percent. So negative results are very likely correct!</p>
<div id="fig:covidfn" class="fignos">
<figure>
<img src="../img/covidfn.png" alt="Figure 2: P(S|+) vs P(S)" /><figcaption aria-hidden="true"><span>Figure 2:</span> P(S|+) vs P(S)</figcaption>
</figure>
</div>
<h2 data-number="1.4" id="independence"><span class="header-section-number">1.4</span> Independence</h2>
<p>Independence is one of the fundamental concepts in probability theory. Conceptually, two events are independent if the occurrence of one has does not influence the likelihood of the occurrence of the other. For example, successive flips of a coin are independent events, since the result of the second flip doesn’t have anything to do with the result of the first. On the other hand, whether or not it rains today and tomorrow are not independent events, since the weather tomorrow depends (in a complicated way) on the weather today.</p>
<p>We can formalize this idea of independence using the following definition.</p>
<p><strong>Definition:</strong> Let <span class="math inline">\(X\)</span> be a sample space and let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be two events. Then <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are <em>independent</em> if <span class="math inline">\(P(A\cap B)=P(A)P(B)\)</span>. Equivalently, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent if <span class="math inline">\(P(A|B)=P(A)\)</span> and <span class="math inline">\(P(B|A)=P(B)\)</span>.</p>
<h3 data-number="1.4.1" id="examples"><span class="header-section-number">1.4.1</span> Examples</h3>
<h4 data-number="1.4.1.1" id="coin-flipping"><span class="header-section-number">1.4.1.1</span> Coin Flipping</h4>
<p>Suppose our coin has a probability of heads given by a real number <span class="math inline">\(p\)</span> between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>, and we flip our coin <span class="math inline">\(N\)</span> times. What is the chance of gettting <span class="math inline">\(k\)</span> heads, where <span class="math inline">\(0\le k\le N\)</span>? Any particular sequence of heads and tails containing <span class="math inline">\(k\)</span> heads and <span class="math inline">\(N-k\)</span> tails has probability <span class="math display">\[
P(\hbox{\rm particular sequence of $k$ heads among $N$ flips}) = p^{k}(1-p)^{N-k}.
\]</span> In addition, there are <span class="math inline">\(\binom{N}{k}\)</span> sequences of heads and tails containing <span class="math inline">\(k\)</span> heads. Thus the probability <span class="math inline">\(P(k,N)\)</span> of <span class="math inline">\(k\)</span> heads among <span class="math inline">\(N\)</span> flips is <span id="eq:binomial" class="eqnos"><span class="math display">\[
P(k,N) = \binom{N}{k}p^{k}(1-p)^{N-k}.
\]</span><span class="eqnos-number">(2)</span></span></p>
<p>Notice that the binomial theorem gives us <span class="math inline">\(\sum_{k=0}^{N} P(k,N) =1\)</span> which is a reassuring check on our work.</p>
<p>The probability distribution on the set <span class="math inline">\(X=\{0,1,\ldots,N\}\)</span> given by <span class="math inline">\(P(k,N)\)</span> is called the <em>binomial distribution</em> with parameters <span class="math inline">\(N\)</span> and <span class="math inline">\(p\)</span>.</p>
<h4 data-number="1.4.1.2" id="a-simple-mixture"><span class="header-section-number">1.4.1.2</span> A simple ‘mixture’</h4>
<p>Now let’s look at an example of events that are not independent. Suppose that we have two coins, with probabilities of heads <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> respectively; and assume these probabilities are different. We play the a game in which we first choose one of the two coins (with equal chance) and then flip it twice. Is the result of the second flip independent of the first? In other words, is <span class="math inline">\(P(HH)=P(H)^2\)</span>?</p>
<p>This type of situation is called a ‘mixture distribution’ because the probability of a head is a “mixture” of the probability coming from the two different coins.</p>
<p>The chance that the first flip is a head is <span class="math inline">\((p_1+p_2)/2\)</span> because it’s the chance of picking the first coin, and then getting a head, plus the chance of picking the second, and then getting a head. The chance of getting two heads in a row is <span class="math inline">\((p_1^2+p_2^2)/2\)</span> because it’s the chance, having picked the first coin, of getting two heads, plus the chance, having picked the second, of getting two heads.</p>
<p>Since <span class="math display">\[
\frac{p_1^2+p_2^2}{2}\not=\left(\frac{p_1+p_2}{2}\right)^2
\]</span> we see these events are not independent.</p>
<p>In terms of conditional probabilities, the chance that the second flip is a head, given that the first flip is, is computed as: <span class="math display">\[
P(HH|H) = \frac{p_1^2+p_2^2}{p_1+p_2}.
\]</span> From the Cauchy-Schwartz inequality one can show that <span class="math display">\[
\frac{p_1^2+p_2^2}{p_1+p_2}&gt;\frac{p_1+p_2}{2}.
\]</span></p>
<p>Why should this be? Why should the chance of getting a head on the second flip go up given that the first flip was a head? One way to think of this is that the first coin flip contains a little bit of information about which coin we chose. If, for example <span class="math inline">\(p_1&gt;p_2\)</span>, and our first flip is heads, then it’s just a bit more likely that we chose the first coin. As a result, the chance of getting another head is just a bit more likely than if we didn’t have that information. We can make this precise by considering the conditional probability <span class="math inline">\(P(p=p_1|H)\)</span> that we’ve chosen the first coin given that we flipped a head. From Bayes’ theorem:</p>
<p><span class="math display">\[
P(p=p_1|H) = \frac{P(H|p=p_1)P(p=p_1)}{P(H)}=\frac{p_1}{p_1+p_2}=\frac{1}{1+(p_2/p_1)}&gt;\frac{1}{2}
\]</span> since <span class="math inline">\((1+(p_2/p_1))&lt;2\)</span>.</p>
<p><strong>Exercise:</strong> Push this argument a bit further. Let <span class="math inline">\(p_1=\max(p_1,p_2)\)</span> Let <span class="math inline">\(P_N\)</span> be the conditional probability of getting heads assuming that the first <span class="math inline">\(N\)</span> flips were heads. Show that <span class="math inline">\(P_N\to p_1\)</span> as <span class="math inline">\(N\to\infty\)</span>. All those heads piling up make it more and more likely that you’re flipping the first coin and so the chance of getting heads approaches <span class="math inline">\(p_1\)</span>.</p>
<h4 data-number="1.4.1.3" id="an-example-with-a-continuous-distribution"><span class="header-section-number">1.4.1.3</span> An example with a continuous distribution</h4>
<p>Suppose that we return to our example of a thermometer which measures the ambient temperature with an error that is distributed according to the normal distribution, as in eq. <a href="#eq:normal">1</a>. Suppose that we make 10 independent measurements <span class="math inline">\(t_1,\ldots, t_{10}\)</span> of the true temperature <span class="math inline">\(t_0\)</span>. What can we say about the distribution of these measurements?</p>
<p>In this case, independence means that <span class="math display">\[
P=P(|t_1-t_0|&lt;\delta,|t_2-t_0|&lt;\delta,\ldots) = P(|t_1-t_0|&lt;\delta)P(|t_2-t_0|&lt;\delta)\cdots P(|t_{10}-t_{0}|&lt;\delta)
\]</span> and therefore <span class="math display">\[
P = \left(\frac{1}{\sigma\sqrt{2\pi}}\right)^{10}\int_{-\delta}^{\delta}\cdots\int_{-\delta}^{\delta}
e^{-(\sum_{i=1}^{10} x_i^2)/2\sigma^2} dx_1\cdots dx_{10}
\]</span></p>
<p>One way to look at this is that the vector <span class="math inline">\(\mathbf{e}\)</span> of errors <span class="math inline">\((|t_1-t_0|,\ldots,|t_{10}-t_0|)\)</span> is distributed according to a <em>multivariate gaussian distribution</em>: <span class="math display">\[
P(\mathbf{e}\in U) =\left(\frac{1}{\sigma\sqrt{2\pi}}\right)^{10}\int_{U} 
e^{-\|x\|^2/2\sigma^2} d\mathbf{x}
\]</span> where <span class="math inline">\(U\)</span> is a region in <span class="math inline">\(\mathbf{R}^{10}\)</span>.</p>
<p>The multivariate gaussian can also describe situations where independence does not hold. For simplicity, let’s work in two dimensions and consider the probability density on <span class="math inline">\(\mathbf{R}^{2}\)</span> given by <span class="math display">\[
P(\mathbf{e}\in U) = A\int_{U} e^{-(x_1^2-x_1x_2+x_2^2)/2\sigma^2} d\mathbf{x}.
\]</span> where the constant <span class="math inline">\(A\)</span> is chosen so that <span class="math display">\[
A\int_{\mathbf{R}^{2}}e^{-(x_1^2-x_1x_2+x_2^2)/2\sigma^2}d\mathbf{x} = 1.
\]</span></p>
<p>This density function as a “bump” concentrated near the origin in <span class="math inline">\(\mathbf{R}^{2}\)</span>, and its level curves are a family of ellipses centered at the origin. See fig. <a href="#fig:multivariate">3</a> for a plot of this function with <span class="math inline">\(\sigma=1\)</span>.</p>
<div id="fig:multivariate" class="fignos">
<figure>
<img src="../img/ellipse.png" alt="Figure 3: Multivariate Gaussian" /><figcaption aria-hidden="true"><span>Figure 3:</span> Multivariate Gaussian</figcaption>
</figure>
</div>
<p>In this situation we can look at the conditional probability of the first variable given the second, and see that the two variables are not independent. Indeed, if we fix <span class="math inline">\(x_2\)</span>, then the distribution of <span class="math inline">\(x_1\)</span> depends on our choice of <span class="math inline">\(x_2\)</span>. We could see this by a calculation, or we can just look at the graph: if <span class="math inline">\(x_2=0\)</span>, then the most likely values of <span class="math inline">\(x_1\)</span> cluster near zero, while if <span class="math inline">\(x_2=1\)</span>, then the most likely values of <span class="math inline">\(x_1\)</span> cluster somewhere above zero.</p>
<h2 data-number="1.5" id="random-variables-mean-and-variance"><span class="header-section-number">1.5</span> Random Variables, Mean, and Variance</h2>
<p>Typically, when we are studying a random process, we aren’t necessarily accessing the underlying events, but rather we are making measurements that provide us with some information about the underlying events. For example, suppose our sample space <span class="math inline">\(X\)</span> is the set of throws of a pair of dice, so <span class="math inline">\(X\)</span> contains the <span class="math inline">\(36\)</span> possible combinations that can arise from the throws. What we are actually interested is the sum of the values of the two dice – that’s our “measurement” of this system. This rather vague notion of a measurement of a random system is captured by the very general idea of a <em>random variable</em>.</p>
<p><strong>Definition:</strong> Let <span class="math inline">\(X\)</span> be a sample space with probability function <span class="math inline">\(P\)</span>. A <em>random variable</em> on <span class="math inline">\(X\)</span> is a function <span class="math inline">\(f:X\to \mathbb{R}\)</span>.</p>
<p>Given a random variable <span class="math inline">\(f\)</span>, we can use the probability measure to decide how likely <span class="math inline">\(f\)</span> is to take a particular value, or values in a particular set by the formula <span class="math display">\[
P(f(x)\in U) = P(f^{-1}(U))
\]</span></p>
<p>In the dice rolling example, the random variable <span class="math inline">\(S\)</span> that assigns their sum to the pair of values obtained on two dice is a random variable. Those values lie between <span class="math inline">\(2\)</span> and <span class="math inline">\(12\)</span> and we have <span class="math display">\[
P(S=k) = P(S^{-1}(\{k\}))=P(\{(x,y): x+y=k\})
\]</span> where <span class="math inline">\((x,y)\)</span> runs through <span class="math inline">\(\{1,2,\ldots,6\}^{2}\)</span> representing the two values and <span class="math inline">\(P((x,y))=1/36\)</span> since all throws are equally likely.</p>
<p>Let’s look at a few more examples, starting with what is probably the most fundamental of all.</p>
<p><strong>Definition:</strong> Let <span class="math inline">\(X\)</span> be a sample space with two elements, say <span class="math inline">\(H\)</span> and <span class="math inline">\(T\)</span>, and suppose that <span class="math inline">\(P(H)=p\)</span> for some <span class="math inline">\(0\le p\le 1\)</span>. Then the random variable that satisfies <span class="math inline">\(f(H)=1\)</span> and <span class="math inline">\(f(T)=0\)</span> is called a Bernoulli random variable with parameter <span class="math inline">\(p\)</span>.</p>
<p>In other words, a Bernoulli random variable gives the value <span class="math inline">\(1\)</span> when a coin flip is heads, and <span class="math inline">\(0\)</span> for tails.</p>
<p>Now let’s look at what we earlier called the binomial distribution.</p>
<p><strong>Definition:</strong> Let <span class="math inline">\(X\)</span> be a sample space consisting of strings of <span class="math inline">\(H\)</span> and <span class="math inline">\(T\)</span> of length <span class="math inline">\(N\)</span>, with the probability of a <em>particular string</em> <span class="math inline">\(S\)</span> with <span class="math inline">\(k\)</span> heads and <span class="math inline">\(N-k\)</span> tails given by <span class="math display">\[
P(S)=p^{k}(1-p)^{N-k}
\]</span> for some <span class="math inline">\(0\le p\le 1\)</span>. In other words, <span class="math inline">\(X\)</span> is the sample space consisting of <span class="math inline">\(N\)</span> independent flips of a coin with probability of heads given by <span class="math inline">\(p\)</span>.<br />
Let <span class="math inline">\(f:X\to \mathbb{R}\)</span> be the function which counts the number of <span class="math inline">\(H\)</span> in the string. Then <span class="math inline">\(f\)</span> is a random variable called a <em>binomial random variable</em> with parameters <span class="math inline">\(p\)</span> and <span class="math inline">\(N\)</span>. Clearly, a binomial random variable with <span class="math inline">\(N=1\)</span> is just a Bernoulli variable with parameter <span class="math inline">\(p\)</span>.</p>
<p>If <span class="math inline">\(f\)</span> is a binomial random variable with parameters <span class="math inline">\(p\)</span> and <span class="math inline">\(N\)</span>, then <span class="math display">\[
P(f=k) = \binom{N}{k}p^{k}(1-p)^{N-k}
\]</span> since <span class="math inline">\(f^{-1}(\{k\})\)</span> is the number of elements in the subset of strings of <span class="math inline">\(H\)</span> and <span class="math inline">\(T\)</span> of length <span class="math inline">\(N\)</span> containing exactly <span class="math inline">\(k\)</span> <span class="math inline">\(H\)</span>’s.</p>
<p>For an example with a continuous random variable, suppose our sample space is <span class="math inline">\(\mathbf{R}^{2}\)</span> and the probability density is the simple multivariate normal <span class="math display">\[
P(\mathbf{e}\in U) = \left(\frac{1}{\sqrt{2\pi}}\right)^2\int_{U} e^{-\|x\|^2/2} d\mathbf{x}.
\]</span> Let <span class="math inline">\(f\)</span> be the random variable <span class="math inline">\(f(\mathbf{x})=\|x\|\)</span>. The function <span class="math inline">\(f\)</span> measures the Euclidean distance of a randomly drawn point from the origin. The set <span class="math display">\[U=f^{-1}([0,r))\subseteq\mathbf{R}^{2}\]</span> is the circle of radius <span class="math inline">\(r\)</span> in <span class="math inline">\(\mathbf{R}^{2}\)</span>. The probability that a randomly drawn point lies in this circle is <span class="math display">\[
P(f&lt;r) = \left(\frac{1}{\sqrt{2\pi}}\right)^2\int_{U} e^{-\|x\|^2/2} d\mathbf{x}.
\]</span></p>
<p>We can actually evaluate this integral in closed form by using polar coordinates. We obtain <span class="math display">\[
P(f&lt;r) = \left(\frac{1}{\sqrt{2\pi}}\right)^2\int_{\theta=0}^{2\pi}\int_{\rho=0}^{r} e^{-\rho^2/2}\rho d\rho d\theta.
\]</span> Since <span class="math display">\[
\frac{d}{d\rho}e^{-\rho^2/2}=-\rho e^{-\rho^2/2}
\]</span> we have <span class="math display">\[\begin{align}
P(f&lt;r)&amp;=-\frac{1}{2\pi}\theta e^{-\rho^2/2}|_{\theta=0}^{2\pi}|_{\rho=0}^{r}\cr
&amp;=1-e^{-r^2/2}\cr
\end{align}\]</span></p>
<p>The probability density associated with this random variable is the derivative of <span class="math inline">\(1-e^{-r^2/2}\)</span> <span class="math display">\[
P(f\in [a,b])=\int_{r=a}^{b} re^{-r^2/2} dr
\]</span> as you can see by the fundamental theorem of calculus. This density is drawn in fig. <a href="#fig:maxwell">4</a> where you can see that the points are clustered at a distance of <span class="math inline">\(1\)</span> from the origin.</p>
<div id="fig:maxwell" class="fignos">
<figure>
<img src="../img/maxwell.png" alt="Figure 4: Density of the Norm" /><figcaption aria-hidden="true"><span>Figure 4:</span> Density of the Norm</figcaption>
</figure>
</div>
<h3 data-number="1.5.1" id="independence-and-random-variables"><span class="header-section-number">1.5.1</span> Independence and Random Variables</h3>
<p>We can extend the notion of independence from events to random variables.</p>
<p><strong>Definition:</strong> Let <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> be two random variables on a sample space <span class="math inline">\(X\)</span> with probability <span class="math inline">\(P\)</span>. Then <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are independent if, for all intervals <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> in <span class="math inline">\(\mathbb{R}\)</span>, the events <span class="math inline">\(f^{-1}(U)\)</span> and <span class="math inline">\(g^{-1}(V)\)</span> are independent.</p>
<p>For discrete probability distributions, this means that, for all <span class="math inline">\(a,b\in\mathbb{R}\)</span>, <span class="math display">\[
P(f=a\hbox{\rm\ and\ }g=b)=P(f=a)P(g=b).
\]</span></p>
<p>For continous probability distributions given by a density function <span class="math inline">\(P(x)\)</span>, independence can be more complicated to figure out.</p>
<h3 data-number="1.5.2" id="expectation-mean-and-variance"><span class="header-section-number">1.5.2</span> Expectation, Mean and Variance</h3>
<p>The most fundamental tool in the study of random variables is the concept of “expectation,” which is a fancy version of average.</p>
<p><strong>Definition:</strong> Let <span class="math inline">\(X\)</span> be a sample space with probability measure <span class="math inline">\(P\)</span>. Let <span class="math inline">\(f:X\to \mathbb{R}\)</span> be a random variable. Then the <em>expected value</em> <span class="math inline">\(E[f]\)</span> of <span class="math inline">\(f\)</span> is <span class="math display">\[
E[f] = \int_X f(x)dP.
\]</span> More specifically, if <span class="math inline">\(X\)</span> is discrete, then <span class="math display">\[
E[f] = \sum_{x\in X} f(x)P(x)
\]</span> while if <span class="math inline">\(X\)</span> is continuous with probability density function <span class="math inline">\(p(x)dx\)</span> then <span class="math display">\[
E[f] = \int_{X} f(x)p(x)dx.
\]</span></p>
<p>If <span class="math inline">\(f\)</span> is a Bernoulli random variable with parameter <span class="math inline">\(p\)</span>, then <span class="math display">\[
E[f] = 1\cdot p+0\cdot (1-p) = p
\]</span></p>
<p>If <span class="math inline">\(f\)</span> is a binomial random variable with parameters <span class="math inline">\(p\)</span> and <span class="math inline">\(N\)</span>, then <span class="math display">\[
E[f] = \sum_{i=0}^{N} i\binom{N}{i}p^{i}(1-p)^{N-i}
\]</span> One can evaluate this using some combinatorial tricks, but it’s easier to apply the following fundamental theorem.</p>
<p><strong>Proposition:</strong> Let <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> be two independent random variables. Then <span class="math inline">\(E[fg]=E[f]E[g]\)</span>.</p>
<p><strong>Proof:</strong> Let’s suppose that the sample space <span class="math inline">\(X\)</span> is discrete. By definition, <span class="math display">\[
E[f]=\sum_{x\in X}f(x)P(x)
\]</span> and we can rewrite this as <span class="math display">\[
E[f]=\sum_{a\in\mathbf{R}} aP(\{x: f(x)=a\}).
\]</span> Let <span class="math inline">\(Z\subset\mathbb{R}\)</span> be the range of <span class="math inline">\(f\)</span>. Then <span class="math display">\[\begin{align}
E[fg]&amp;=\sum_{a\in Z} aP(\{x: fg(x)=a\}) \\
&amp;=\sum_{a\in Z}\sum_{(u,v)\in\mathbf{Z}^{2}\atop{uv=a}}aP(\{x:f(x)=u\hbox{\rm\ and\ }g(x)=v\}) \\
&amp;=\sum_{a\in Z}\sum_{(u,v)\in\mathbf{Z}^{2}\atop{uv=a}}uvP(\{x:f(x)=u\})P(\{x:g(x)=v\}) \\
&amp;=\sum_{u\in Z}uP(\{x:f(x)=u\})\sum_{v\in Z}vP(\{x:f(x)=v\}) \\
&amp;=E[f]E[g] 
\end{align}\]</span></p>
<h2 data-number="1.6" id="models-and-likelihood"><span class="header-section-number">1.6</span> Models and Likelihood</h2>
<p>A <em>statistical model</em> is a mathematical model that accounts for data via a process that incorporates random behavior in a structured way. We have seen several examples of such models in our discussion so far. For example, the Bernoulli process that describes the outcome of a series of coin flips as independent choices of heads or tails with probability <span class="math inline">\(p\)</span> is a simple statistical model; our more complicated mixture model in which we choose one of two coins at random and then flip that is a more complicated model.<br />
Our description of the variation in temperature measurements as arising from perturbations from the true temperature by a normally distributed amount is another example of a statistical model, this one involving a continuous random variable.</p>
<p>When we apply a mathematical model to understand data, we often have a variety of parameters in the model that we must adjust to get the model to best “fit” the observed data. For example, suppose that we observe the vibrations of a block attached to a spring. We know that the motion is governed by a second order linear differential equation, but the dynamics depend on the mass of the block, the spring constant, and the damping coefficient. By measuring the dynamics of the block over time, we can try to work backwards to figure out these parameters, after which we will be able to predict the block’s motion into the future.</p>
<h4 data-number="1.6.0.1" id="maximum-likelihood-discrete-case"><span class="header-section-number">1.6.0.1</span> Maximum Likelihood (Discrete Case)</h4>
<p>To see this process in a statistical setting, let’s return to the simple example of a coin flip. The only parameter in our model is the probability <span class="math inline">\(p\)</span> of getting heads on a particular flip. Suppose that we flip the coin <span class="math inline">\(100\)</span> times and get <span class="math inline">\(55\)</span> heads and <span class="math inline">\(45\)</span> tails. What can we say about <span class="math inline">\(p\)</span>?</p>
<p>We will approach this question via the “likelihood” function for our data. We ask: for a particular value of the parameter <span class="math inline">\(p\)</span>, how likely is this outcome? From eq. <a href="#eq:binomial">2</a> we have <span class="math display">\[
P(55H,45T)=\binom{100}{55}p^{55}(1-p)^{45}.
\]</span></p>
<p>This function is plotted in fig. <a href="#fig:beta">5</a>. As you can see from that plot, it is extremely unlikely that we would have gotten <span class="math inline">\(55\)</span> heads if <span class="math inline">\(p\)</span> was smaller than <span class="math inline">\(.4\)</span> or greater than <span class="math inline">\(.7\)</span>, while the <em>most likely</em> value of <span class="math inline">\(p\)</span> occurs at the maximum value of this function, and a little calculus tells us that this point is where <span class="math inline">\(p=.55\)</span>. This <em>most likely</em> value of <span class="math inline">\(p\)</span> is called the <em>maximum likelihood estimate</em> for the parameter <span class="math inline">\(p\)</span>.</p>
<div id="fig:beta" class="fignos">
<figure>
<img src="../img/beta.png" alt="Figure 5: Likelihood Plot" /><figcaption aria-hidden="true"><span>Figure 5:</span> Likelihood Plot</figcaption>
</figure>
</div>
<h4 data-number="1.6.0.2" id="maximum-likelihood-continuous-case"><span class="header-section-number">1.6.0.2</span> Maximum Likelihood (Continuous Case)</h4>
<h2 data-number="1.7" id="bayes-theorem-1"><span class="header-section-number">1.7</span> Bayes Theorem</h2>
<h3 data-number="1.7.1" id="conditional-probability"><span class="header-section-number">1.7.1</span> Conditional probability</h3>
<h3 data-number="1.7.2" id="bayes-theorem-2"><span class="header-section-number">1.7.2</span> Bayes Theorem</h3>
<h3 data-number="1.7.3" id="bayesian-inference"><span class="header-section-number">1.7.3</span> Bayesian inference</h3>
<h4 data-number="1.7.3.1" id="priors"><span class="header-section-number">1.7.3.1</span> Priors</h4>
<h4 data-number="1.7.3.2" id="data"><span class="header-section-number">1.7.3.2</span> Data</h4>
<h4 data-number="1.7.3.3" id="posterior"><span class="header-section-number">1.7.3.3</span> Posterior</h4>
<h1 class="unnumbered" id="bibliography">References</h1>
<div id="refs" class="references csl-bib-body" role="doc-bibliography">
<div id="ref-Bertsekas" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline"><span class="smallcaps">Bertsekas</span>, D. P. and <span class="smallcaps">Tsitsiklis</span>, J. N. (2008). <em>Introduction to probability</em>. Athena Scientific.</div>
</div>
</div>
</body>
</html>
